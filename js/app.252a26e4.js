(function(t){function e(e){for(var n,r,s=e[0],c=e[1],l=e[2],d=0,p=[];d<s.length;d++)r=s[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&p.push(o[r][0]),o[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(p.length)p.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],n=!0,s=1;s<a.length;s++){var c=a[s];0!==o[c]&&(n=!1)}n&&(i.splice(e--,1),t=r(r.s=a[0]))}return t}var n={},o={app:0},i=[];function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=n,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/vue-weather/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0204":function(t,e,a){},"0207":function(t,e,a){"use strict";var n=a("627c"),o=a.n(n);o.a},"0ef9":function(t,e,a){},"11cb":function(t,e,a){"use strict";var n=a("0ef9"),o=a.n(n);o.a},"14cd":function(t,e,a){"use strict";var n=a("3a6a"),o=a.n(n);o.a},2056:function(t,e,a){"use strict";var n=a("45d9"),o=a.n(n);o.a},"3a6a":function(t,e,a){},"45d9":function(t,e,a){},"4a8d":function(t,e,a){"use strict";var n=a("5ca6"),o=a.n(n);o.a},"4d00":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("Header"),a("router-view")],1)},i=[],r=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"header"},[a("div",{staticClass:"header__title"},[t._v("Weather app")])])}],c={name:"Header"},l=c,u=(a("ebc6"),a("2877")),d=Object(u["a"])(l,r,s,!1,null,"48c26569",null),p=d.exports,f={name:"App",components:{Header:p}},m=f,h=(a("5c0b"),Object(u["a"])(m,o,i,!1,null,null,null)),v=h.exports,y=a("8c4f"),g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("Toast",{attrs:{error:this.error}}),a("transition",{attrs:{name:"fade"}},[t.localStorageApiKey||t.storeApiKey?t._e():a("Welcome",{attrs:{update:this.findLocation}})],1),a("transition",{attrs:{name:"fade"}},[t.storeApiKey?a("MainBlock",{attrs:{today:this.today,forecastList:this.forecastList,activeDay:this.activeDay,getTime:this.getTime,getTempC:this.getTempC,getConvertedDate:this.getConvertedDate}}):t._e()],1),a("transition",{attrs:{name:"fade"}},[t.storeApiKey?a("Forecast",{attrs:{forecastListForEachDay:this.forecastListForEachDay,findLocation:this.findLocation,getTempC:this.getTempC,setActiveDay:this.setActiveDay}}):t._e()],1),a("transition",{attrs:{name:"fade"}},[t.storeApiKey?a("Map",{attrs:{coords:t.mapCoords,findLocation:t.findLocation}}):t._e()],1)],1)},_=[],C=(a("99af"),a("4160"),a("fb6a"),a("d3b7"),a("ac1f"),a("5319"),a("159b"),a("96cf"),a("1da1")),D=a("2909"),b=a("bc3a"),w=a.n(b),L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return this.error?a("transition",{attrs:{name:"easeOutBounce"}},[a("div",{staticClass:"toast"},[a("span",[t._v("Не удалось получить местоположение.")])])]):t._e()},A=[],K={name:"Toast",props:["error"]},k=K,x=(a("c522"),Object(u["a"])(k,L,A,!1,null,"08516448",null)),O=x.exports,S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"welcome"},[a("Card",[a("div",{staticClass:"welcome__title"},[t._v("Введите API-ключ")]),a("div",{staticClass:"welcome__body"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.localApiKey,expression:"localApiKey"}],staticClass:"welcome__input welcome__input--api",attrs:{type:"text",placeholder:"API-ключ",autofocus:""},domProps:{value:t.localApiKey},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setApiKey(t.localApiKey)},input:function(e){e.target.composing||(t.localApiKey=e.target.value)}}}),a("button",{staticClass:"welcome__submit",class:{active:t.localApiKey},on:{click:function(e){return t.setApiKey(t.localApiKey)}}},[t._v(" Подтвердить ")])])])],1)},F=[],$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card",class:{skeleton:t.loading}},[t._t("default")],2)},T=[],E={name:"Card",computed:{loading:function(){return this.$store.state.loading}}},j=E,M=(a("4a8d"),Object(u["a"])(j,$,T,!1,null,"69b2ef24",null)),P=M.exports,W={name:"Welcome",components:{Card:P},props:{update:Function},data:function(){return{localApiKey:this.apiKey}},methods:{setApiKey:function(t){this.$store.commit("setApiKey",t),this.update()}},computed:{apiKey:{get:function(){return this.$store.state.apiKey}}}},H=W,I=(a("14cd"),Object(u["a"])(H,S,F,!1,null,"a2d98a82",null)),B=I.exports,N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Card",{staticClass:"main"},[a("div",{staticClass:"main__header"},[t.loading&&!t.today.temp?a("Skeleton",{staticClass:"main__temp temp",attrs:{width:"100px",height:"100px"}}):a("div",{staticClass:"main__temp temp"},[a("span",{staticClass:"temp__number"},[t._v(t._s(t.getTempC(t.today.temp)))]),a("span",{staticClass:"temp__unit"},[t._v(" °C")])]),t.loading&&!t.today.date?a("Skeleton",{staticClass:"main__title title",attrs:{width:"200px",height:"50px"}}):a("div",{staticClass:"main__title title"},[a("span",[t._v(t._s(this.activeDay))])]),t.loading&&!t.today.icon?a("Skeleton",{staticClass:"main__icon",attrs:{width:"100px",height:"100px"}}):a("img",{staticClass:"main__icon",attrs:{src:"http://openweathermap.org/img/wn/"+t.today.icon+"@2x.png",alt:"Weather icon"}})],1),a("div",{staticClass:"main__body"},[a("ForecastDay",{staticClass:"main__forecast-day",attrs:{activeDay:this.activeDay,forecastList:this.forecastList,getTime:this.getTime,getTempC:this.getTempC,getConvertedDate:this.getConvertedDate}})],1)])},R=[],J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"skeleton",style:{height:t.height,width:t.computedWidth}})},U=[],q=(a("a9e3"),{name:"Skeleton",props:{maxWidth:{default:100,type:Number},minWidth:{default:80,type:Number},height:{default:"1em",type:String},width:{default:null,type:String}},computed:{computedWidth:function(){return this.width||"".concat(Math.floor(Math.random()*(this.maxWidth-this.minWidth)+this.minWidth),"%")}}}),z=q,G=(a("8d2a"),Object(u["a"])(z,J,U,!1,null,null,null)),Q=G.exports,V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"forecast-day",class:{skeleton:t.loading}},[t.loading?a("Skeleton",{staticClass:"forecast-day__inner",attrs:{width:"100%",height:"143px"}}):a("div",{staticClass:"forecast-day__inner"},t._l(t.getForecastListOfDay(this.forecastList),(function(e){return a("div",{key:e.dt,staticClass:"forecast-day__item item"},[a("div",{staticClass:"item__temp"},[a("span",{staticClass:"item__temp-number"},[t._v(t._s(t.getTempC(e.main.temp)))]),a("span",{staticClass:"item__temp-unit"},[t._v(" °C")])]),a("div",{staticClass:"item__descr"},[a("span",[t._v(t._s(t.transformFirstSymbol(e.weather[0].description)))])]),a("div",{staticClass:"item__time"},[a("span",[t._v(t._s(t.getTime(e.dt)))])]),a("img",{staticClass:"item__icon",attrs:{src:"http://openweathermap.org/img/wn/"+e.weather[0].icon+".png",alt:"Weather icon"}})])})),0)],1)},X=[],Y={name:"ForecastDay",components:{Skeleton:Q},props:{activeDay:String,forecastList:Array,getTime:Function,getTempC:Function,getConvertedDate:Function},methods:{getForecastListOfDay:function(t){var e=this,a=[];if(t)return t.forEach((function(t){e.activeDay===e.getConvertedDate(t.dt)&&a.push(t)})),a},transformFirstSymbol:function(t){return t?t[0].toUpperCase()+t.slice(1):t}},computed:{loading:function(){return this.$store.state.loading}}},Z=Y,tt=(a("c280"),Object(u["a"])(Z,V,X,!1,null,"0048197c",null)),et=tt.exports,at={name:"MainBlock",components:{Card:P,Skeleton:Q,ForecastDay:et},props:{today:Object,forecastList:Array,activeDay:String,getTime:Function,getTempC:Function,getConvertedDate:Function},computed:{loading:function(){return this.$store.state.loading}}},nt=at,ot=(a("69d8"),Object(u["a"])(nt,N,R,!1,null,"0cfaa1d2",null)),it=ot.exports,rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Card",{staticClass:"forecast",class:{skeletonLoaded:t.loading&&this.forecastListForEachDay}},[t.loading&&!this.forecastListForEachDay?a("Skeleton",{staticClass:"forecast__day day",attrs:{width:"100%",height:"110px"}}):t._l(this.forecastListForEachDay,(function(e,n){return a("div",{key:e.dt,staticClass:"forecast__day day",class:{active:n===t.activeDay},on:{click:function(){t.findLocation.apply(void 0,t.coords),t.setActiveDay(n)}}},[a("div",{staticClass:"day__date"},[a("span",[t._v(t._s(n))])]),a("div",{staticClass:"day__temp temp"},[a("div",{staticClass:"temp__number"},[t._v(" "+t._s(t.getTempC(t.getAverageTempOfDay(e)))+" ")]),a("div",{staticClass:"temp__unit"},[t._v("°C")])])])}))],2)},st=[],ct=(a("13d5"),{name:"Forecast",components:{Card:P,Skeleton:Q},props:{forecastListForEachDay:Object,findLocation:Function,getTempC:Function,setActiveDay:Function},methods:{getAverageTempOfDay:function(t){var e=[],a=null,n=null;return t.forEach((function(t){var a;e.push(null===t||void 0===t||null===(a=t.main)||void 0===a?void 0:a.temp)})),a=e.reduce((function(t,e){return t+e}),0),n=a/e.length,n=Math.round(n),n}},computed:{activeDay:function(){return this.$store.state.activeDay},coords:function(){return this.$store.state.coords},loading:function(){return this.$store.state.loading}}}),lt=ct,ut=(a("11cb"),Object(u["a"])(lt,rt,st,!1,null,"191f0df4",null)),dt=ut.exports,pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Card",{staticClass:"map",class:{skeletonLoaded:t.loading&&2===this.localCoords.length}},[t.loading&&2!==this.localCoords.length?a("Skeleton",{attrs:{width:"100%",height:"100%"}}):a("yandex-map",{attrs:{settings:this.ymapSettings,coords:this.localCoords},on:{click:t.getPosition}},[a("ymap-marker",{attrs:{coords:this.localCoords,"marker-id":"1","hint-content":"Вы здесь"}})],1)],1)},ft=[],mt=a("f5ce"),ht={name:"Map",components:{Card:P,Skeleton:Q,yandexMap:mt["a"],ymapMarker:mt["b"]},props:{coords:Array,findLocation:Function},data:function(){return{localCoords:this.coords,ymapSettings:{apiKey:"88a99d43-03f8-4572-be63-fae267111ff9",lang:"ru_RU",coordorder:"latlong",version:"2.1"}}},methods:{getPosition:function(t){this.localCoords=t.get("coords"),this.findLocation.apply(this,Object(D["a"])(this.localCoords)),this.$store.commit("setCoords",this.localCoords)}},computed:{loading:function(){return this.$store.state.loading}}},vt=ht,yt=(a("2056"),Object(u["a"])(vt,pt,ft,!1,null,"52816795",null)),gt=yt.exports,_t={name:"Home",components:{Toast:O,Welcome:B,MainBlock:it,Forecast:dt,Map:gt},data:function(){return{apiKey:null,today:{date:null,temp:null,icon:null},mapCoords:[],forecastList:null,forecastListOfDay:null,forecastListForEachDay:null,averageTempOfDay:null,error:!1}},mounted:function(){var t=this,e=setInterval((function(){if(localStorage.apiKey){t.apiKey=localStorage.apiKey,t.$store.commit("setApiKey",t.apiKey),t.findLocation.apply(t,Object(D["a"])(t.storeCoords));var a=setInterval((function(){t.today.date&&(t.setActiveDay(t.getConvertedDate(t.today.date)),clearInterval(a))}),100);clearInterval(e)}}),0)},methods:{findLocation:function(){var t,e,a=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.$store.commit("setLoading",!0);var i=function(){var i=Object(C["a"])(regeneratorRuntime.mark((function i(r){var s,c;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n||o){i.next=9;break}return i.next=3,null===r||void 0===r||null===(s=r.coords)||void 0===s?void 0:s.latitude;case 3:return t=i.sent,i.next=6,null===r||void 0===r||null===(c=r.coords)||void 0===c?void 0:c.longitude;case 6:e=i.sent,i.next=11;break;case 9:t=n,e=o;case 11:t&&e&&(2===a.mapCoords.length?(a.mapCoords=[],a.mapCoords.push(t,e)):a.mapCoords.push(t,e)),w.a.get("https://api.openweathermap.org/data/2.5/weather?lat=".concat(t,"&lon=").concat(e,"&appid=").concat(a.storeApiKey,"&lang=ru")).then((function(t){var e,n,o,i,r,s;a.today.date=null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.dt,a.today.temp=null===t||void 0===t||null===(n=t.data)||void 0===n||null===(o=n.main)||void 0===o?void 0:o.temp,a.today.icon=null===t||void 0===t||null===(i=t.data)||void 0===i||null===(r=i.weather)||void 0===r||null===(s=r[0])||void 0===s?void 0:s.icon,a.error=!1})).catch((function(t){a.error=t,a.$store.commit("setApiKey","")})).finally((function(){return a.$store.commit("setLoading",!1)})),w.a.get("https://api.openweathermap.org/data/2.5/forecast?lat=".concat(t,"&lon=").concat(e,"&appid=").concat(a.storeApiKey,"&lang=ru")).then((function(t){a.forecastList=t.data.list,a.forecastListForEachDay=a.getForecastListForEachDay(a.forecastList),a.error=!1})).catch((function(t){a.error=t,a.$store.commit("setApiKey","")})).finally((function(){return a.loading=!1}));case 14:case"end":return i.stop()}}),i)})));return function(t){return i.apply(this,arguments)}}(),r=function(t){a.error=t};navigator.geolocation.getCurrentPosition(i,r)},getDate:function(t){if(t)return new Date(1e3*t).toLocaleDateString("ru",{day:"numeric",month:"long"})},getConvertedDate:function(t){var e=this.getDate(t).slice(0,2).replace(/[, ]/g,"")===(new Date).toLocaleDateString("ru",{day:"numeric"}),a=this.getDate(t).slice(0,2).replace(/[, ]/g,"")===String(+(new Date).toLocaleDateString("ru",{day:"numeric"})+1);return e?"Сегодня":a?"Завтра":this.getDate(t)},getTime:function(t){var e=new Date(1e3*t).getHours(),a=new Date(1e3*t).getMinutes(),n=/^[0-9]$/.test(e)?"0".concat(e):e,o=/^[0-9]$/.test(a)?"0".concat(a):a;return"".concat(n,":").concat(o)},getTempC:function(t){return"number"!==typeof t?"--":Math.round(t-275.15)},getTempF:function(t){return"number"!==typeof t?"--":Math.round(1.8*(t-275.15)+32)},getForecastListForEachDay:function(t){var e=this,a=null,n=[],o={};return t.forEach((function(t){e.getConvertedDate(t.dt)!==a?(a=e.getConvertedDate(t.dt),n=[],n.push(t),o[e.getConvertedDate(t.dt)]=n):(n.push(t),o[e.getConvertedDate(t.dt)]=n)})),o},setActiveDay:function(t){this.$store.commit("setActiveDay",t)}},computed:{storeApiKey:function(){return this.$store.state.apiKey},localStorageApiKey:function(){return localStorage.apiKey},activeDay:function(){return this.$store.state.activeDay},storeCoords:function(){return this.$store.state.coords}}},Ct=_t,Dt=(a("0207"),Object(u["a"])(Ct,g,_,!1,null,"4beb183a",null)),bt=Dt.exports;n["a"].use(y["a"]);var wt=[{path:"/",name:"Home",component:bt}],Lt=new y["a"]({mode:"history",base:"/vue-weather/",routes:wt}),At=Lt,Kt=a("2f62");n["a"].use(Kt["a"]);var kt=new Kt["a"].Store({state:{apiKey:null,activeDay:null,coords:[],loading:!1},mutations:{setApiKey:function(t,e){t.apiKey=e,localStorage.apiKey=e},setActiveDay:function(t,e){t.activeDay=e},setCoords:function(t,e){t.coords=e},setLoading:function(t,e){t.loading=e}},actions:{},modules:{}});n["a"].config.productionTip=!1,new n["a"]({router:At,store:kt,render:function(t){return t(v)}}).$mount("#app")},"5c0b":function(t,e,a){"use strict";var n=a("9c0c"),o=a.n(n);o.a},"5ca6":function(t,e,a){},"627c":function(t,e,a){},"69d8":function(t,e,a){"use strict";var n=a("ea34"),o=a.n(n);o.a},"8d2a":function(t,e,a){"use strict";var n=a("9da0"),o=a.n(n);o.a},"9c0c":function(t,e,a){},"9da0":function(t,e,a){},ad86:function(t,e,a){},c280:function(t,e,a){"use strict";var n=a("0204"),o=a.n(n);o.a},c522:function(t,e,a){"use strict";var n=a("4d00"),o=a.n(n);o.a},ea34:function(t,e,a){},ebc6:function(t,e,a){"use strict";var n=a("ad86"),o=a.n(n);o.a}});